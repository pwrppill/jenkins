Started by user name
Running as SYSTEM
Building in workspace /var/jenkins_home/workspace/hw10_task1
[SSH] script:
version="1.0.13"

echo -e "{\n\"insecure-registries\" : [\"http://130.193.55.151:8123\"]\n}" >> /etc/docker/daemon.json
apt update && apt install git docker.io -y
git clone https://github.com/pwrppill/repo.git
docker build -t myapp:$version ./repo
docker tag myapp:$version 130.193.55.151:8123/myapp:$version
docker login -u admin -p admin 130.193.55.151:8123
docker push [130.193.55.151:8123/myapp:$version]

[SSH] executing...

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

Hit:1 http://mirror.yandex.ru/ubuntu focal InRelease
Get:2 http://mirror.yandex.ru/ubuntu focal-updates InRelease [114 kB]
Get:3 http://mirror.yandex.ru/ubuntu focal-backports InRelease [108 kB]
Get:4 http://security.ubuntu.com/ubuntu focal-security InRelease [114 kB]
Fetched 336 kB in 1s (455 kB/s)
Reading package lists...
Building dependency tree...
WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

fatal: destination path 'repo' already exists and is not an empty directory.

Reading state information...
22 packages can be upgraded. Run 'apt list --upgradable' to see them.
Reading package lists...
Building dependency tree...
Reading state information...
git is already the newest version (1:2.25.1-1ubuntu3.10).
docker.io is already the newest version (20.10.12-0ubuntu2~20.04.1).
0 upgraded, 0 newly installed, 0 to remove and 22 not upgraded.
WARNING! Using --password via the CLI is insecure. Use --password-stdin.
Error response from daemon: Get "https://130.193.55.151:8123/v2/": http: server gave HTTP response to HTTPS client
invalid reference format
Sending build context to Docker daemon  75.26kB

Step 1/9 : FROM tomcat:latest
 ---> 51adadb96917
Step 2/9 : RUN apt update
 ---> Using cache
 ---> 202e28be8e03
Step 3/9 : RUN apt install maven git -y
 ---> Using cache
 ---> ab9a1647ee27
Step 4/9 : RUN apt install default-jdk -y
 ---> Using cache
 ---> cf8f0513151d
Step 5/9 : RUN apt install git -y
 ---> Using cache
 ---> 5a74f74b3543
Step 6/9 : RUN git clone https://github.com/jetty-project/embedded-jetty-live-war.git
 ---> Using cache
 ---> 94a7d008c3c0
Step 7/9 : WORKDIR ./embedded-jetty-live-war/
 ---> Using cache
 ---> 8230729942ab
Step 8/9 : RUN mvn package
 ---> Using cache
 ---> f5a27893c160
Step 9/9 : RUN cp ./thewebapp/target/thewebapp.war /usr/local/tomcat/webapps
 ---> Using cache
 ---> f47a7b4162bd
Successfully built f47a7b4162bd
Successfully tagged myapp:1.0.13

[SSH] completed
[SSH] exit-status: 1

Build step 'Execute shell script on remote host using ssh' marked build as failure
Finished: FAILURE
